(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{134:function(e,t,r){},192:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),s=r(11),c=r.n(s),o=(r(134),r(13)),i=r(8),u=r.n(i),l=r(233),d=r(42),j=r(119),b=Object(j.a)({typography:{fontFamily:"Open Sans, sans-serif",fontSize:14,button:{textTransform:"none",letterSpacing:0,fontWeight:"bold"}},overrides:{MuiInput:{input:{fontWeight:"bold"}}},palette:{primary:{main:"#3A8DFF"},secondary:{main:"#B0B0B0"}}}),f=r(29),h=r(15),p=r(28),m=r.n(p),x=r(14),g=r(222),O=r(235),v=r(195),w=r(236),C=r(225),y=r(234),k=r(228),S=r(2),U=function(e){var t=e.user,r=e.register,a=Object(x.f)(),s=Object(n.useState)({}),c=Object(h.a)(s,2),i=c[0],l=c[1],j=function(){var e=Object(o.a)(u.a.mark((function e(t){var n,a,s,c,o,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=t.currentTarget,a=n.elements,s=a.username.value,c=a.email.value,o=a.password.value,i=a.confirmPassword.value,o===i){e.next=10;break}return l({confirmPassword:"Passwords must match"}),e.abrupt("return");case 10:return e.next=12,r({username:s,email:c,password:o});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){t&&t.id&&a.push("/home")}),[t,a]),Object(S.jsx)(g.a,{container:!0,justifyContent:"center",children:Object(S.jsxs)(O.a,{children:[Object(S.jsxs)(g.a,{container:!0,item:!0,children:[Object(S.jsx)(v.a,{children:"Need to log in?"}),Object(S.jsx)(d.b,{href:"/login",to:"/login",children:Object(S.jsx)(w.a,{children:"Login"})})]}),Object(S.jsx)("form",{onSubmit:j,children:Object(S.jsxs)(g.a,{children:[Object(S.jsx)(g.a,{children:Object(S.jsx)(C.a,{children:Object(S.jsx)(y.a,{"aria-label":"username",label:"Username",name:"username",type:"text",required:!0})})}),Object(S.jsx)(g.a,{children:Object(S.jsx)(C.a,{children:Object(S.jsx)(y.a,{label:"E-mail address","aria-label":"e-mail address",type:"email",name:"email",required:!0})})}),Object(S.jsx)(g.a,{children:Object(S.jsxs)(C.a,{error:!!i.confirmPassword,children:[Object(S.jsx)(y.a,{"aria-label":"password",label:"Password",type:"password",inputProps:{minLength:6},name:"password",required:!0}),Object(S.jsx)(k.a,{children:i.confirmPassword})]})}),Object(S.jsx)(g.a,{children:Object(S.jsxs)(C.a,{error:!!i.confirmPassword,children:[Object(S.jsx)(y.a,{label:"Confirm Password","aria-label":"confirm password",type:"password",inputProps:{minLength:6},name:"confirmPassword",required:!0}),Object(S.jsx)(k.a,{children:i.confirmPassword})]})}),Object(S.jsx)(w.a,{type:"submit",variant:"contained",size:"large",children:"Create"})]})})]})})},N=function(e){var t=e.user,r=e.login,a=Object(x.f)(),s=function(){var e=Object(o.a)(u.a.mark((function e(t){var n,a,s,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=t.currentTarget,a=n.elements,s=a.username.value,c=a.password.value,e.next=7,r({username:s,password:c});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){t&&t.id&&a.push("/home")}),[t,a]),Object(S.jsx)(g.a,{container:!0,justifyContent:"center",children:Object(S.jsxs)(O.a,{children:[Object(S.jsxs)(g.a,{container:!0,item:!0,children:[Object(S.jsx)(v.a,{children:"Need to register?"}),Object(S.jsx)(d.b,{href:"/register",to:"/register",children:Object(S.jsx)(w.a,{children:"Register"})})]}),Object(S.jsx)("form",{onSubmit:s,children:Object(S.jsxs)(g.a,{children:[Object(S.jsx)(g.a,{children:Object(S.jsx)(C.a,{margin:"normal",required:!0,children:Object(S.jsx)(y.a,{"aria-label":"username",label:"Username",name:"username",type:"text"})})}),Object(S.jsx)(C.a,{margin:"normal",required:!0,children:Object(S.jsx)(y.a,{label:"password","aria-label":"password",type:"password",name:"password"})}),Object(S.jsx)(g.a,{children:Object(S.jsx)(w.a,{type:"submit",variant:"contained",size:"large",children:"Login"})})]})})]})})},F=r(24),I=r(232),E=r(229),D=Object(E.a)((function(e){return{root:{display:"flex",justifyContent:"space-between",marginLeft:20,flexGrow:1},username:{fontWeight:"bold",letterSpacing:-.2},previewText:{fontSize:12,color:"#9CADC8",letterSpacing:-.17}}})),A=function(e){var t=e.conversation,r=D(),n=t.otherUser,a=t.id&&t.latestMessageText;return Object(S.jsx)(O.a,{className:r.root,children:Object(S.jsxs)(O.a,{children:[Object(S.jsx)(v.a,{className:r.username,children:n.username}),Object(S.jsx)(v.a,{className:r.previewText,children:a})]})})},B=r(70),T=r.n(B),P=Object(E.a)((function(){return{root:{height:44,marginTop:23,marginLeft:6,display:"flex",alignItems:"center"},subContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",flexGrow:1},username:{letterSpacing:-.23,fontSize:16,fontWeight:"bold",marginLeft:17},ellipsis:{color:"#95A7C4",marginRight:24,opacity:.5}}})),W=function(e){var t=e.user,r=P();return Object(S.jsxs)(O.a,{className:r.root,children:[Object(S.jsx)(Z,{photoUrl:null===t||void 0===t?void 0:t.photoUrl,online:!0}),Object(S.jsxs)(O.a,{className:r.subContainer,children:[Object(S.jsx)(v.a,{className:r.username,children:null===t||void 0===t?void 0:t.username}),Object(S.jsx)(T.a,{classes:{root:r.ellipsis}})]})]})},z=r(226),L=r(230),R=r(115),M=r.n(R),q=Object(E.a)((function(){return{filledInput:{height:50,background:"#E9EEF9",borderRadius:5,fontSize:13,fontWeight:"bold",color:"#99A9C4",letterSpacing:0,display:"flex",justifyContent:"center",marginBottom:20},input:{"&::placeholder":{color:"#ADC0DE",opacity:1}}}})),G=function(e){var t=e.handleChange,r=q();return Object(S.jsx)("form",{onSubmit:function(e){e.preventDefault()},children:Object(S.jsx)(C.a,{fullWidth:!0,hiddenLabel:!0,children:Object(S.jsx)(z.a,{name:"search",onChange:t,classes:{root:r.filledInput,input:r.input},disableUnderline:!0,placeholder:"Search",startAdornment:Object(S.jsx)(L.a,{position:"start",children:Object(S.jsx)(M.a,{})})})})})},J=Object(E.a)((function(){return{root:{paddingLeft:21,paddingRight:21,flexGrow:1},title:{fontSize:20,letterSpacing:-.29,fontWeight:"bold",marginTop:32,marginBottom:15}}})),$=function(e){var t=e.handleChange,r=e.searchTerm,n=e.conversations,a=void 0===n?[]:n,s=e.user,c=e.setActiveChat,o=J();return Object(S.jsxs)(O.a,{className:o.root,children:[Object(S.jsx)(W,{user:s}),Object(S.jsx)(v.a,{className:o.title,children:"Chats"}),Object(S.jsx)(G,{handleChange:t}),a.filter((function(e){return e.otherUser.username.includes(r)})).map((function(e){return Object(S.jsx)(Q,{conversation:e,setActiveChat:c},e.otherUser.username)}))]})},H=function(e){var t=e.conversations,r=e.user,a=e.clearSearchedUsers,s=e.addSearchedUsers,c=e.setActiveChat,i=Object(n.useState)(""),l=Object(h.a)(i,2),d=l[0],j=l[1],b=function(){var e=Object(o.a)(u.a.mark((function e(t){var r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.get("/api/users/".concat(t));case 3:r=e.sent,n=r.data,s(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(o.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t.target.value){e.next=4;break}return a(),j(""),e.abrupt("return");case 4:if(!d.includes(t.target.value)){e.next=7;break}return j(t.target.value),e.abrupt("return");case 7:return e.next=9,b(t.target.value);case 9:j(t.target.value);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(S.jsx)($,{handleChange:f,searchTerm:d,conversations:t,user:r,setActiveChat:c})},K=Object(E.a)((function(e){return{root:{borderRadius:8,height:80,boxShadow:"0 2px 10px 0 rgba(88,133,196,0.05)",marginBottom:10,display:"flex",alignItems:"center","&:hover":{cursor:"grab"}}}})),Q=function(e){var t=e.conversation,r=e.setActiveChat,n=K(),a=t.otherUser,s=function(){var e=Object(o.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t.otherUser.username);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(S.jsxs)(O.a,{onClick:function(){return s(t)},className:n.root,children:[Object(S.jsx)(Z,{photoUrl:a.photoUrl,username:a.username,online:a.online,sidebar:!0}),Object(S.jsx)(A,{conversation:t})]})},V=r(231),X=r(239),Y=Object(E.a)((function(){return{profilePic:{height:44,width:44},badge:{height:13,width:13,borderRadius:"50%",border:"2px solid white",backgroundColor:"#D0DAE9"},online:{backgroundColor:"#1CED84"},sidebar:{marginLeft:17}}})),Z=function(e){var t=e.sidebar,r=e.username,n=e.photoUrl,a=e.online,s=Y();return Object(S.jsx)(O.a,{className:t?s.sidebar:"",children:Object(S.jsx)(V.a,{classes:{badge:"".concat(s.badge," ").concat(a&&s.online)},variant:"dot",anchorOrigin:{horizontal:"right",vertical:"bottom"},overlap:"circular",children:Object(S.jsx)(X.a,{alt:r,src:n,className:s.profilePic})})})},_=Object(E.a)((function(){return{root:{display:"flex",flexDirection:"column",alignItems:"flex-end"},date:{fontSize:11,color:"#BECCE2",fontWeight:"bold",marginBottom:5},text:{fontSize:14,color:"#91A3C0",letterSpacing:-.2,padding:8,fontWeight:"bold"},bubble:{background:"#F4F6FA",borderRadius:"10px 10px 0 10px"}}})),ee=function(e){var t=e.time,r=e.text,n=_();return Object(S.jsxs)(O.a,{className:n.root,children:[Object(S.jsx)(v.a,{className:n.date,children:t}),Object(S.jsx)(O.a,{className:n.bubble,children:Object(S.jsx)(v.a,{className:n.text,children:r})})]})},te=Object(E.a)((function(){return{root:{display:"flex"},avatar:{height:30,width:30,marginRight:11,marginTop:6},usernameDate:{fontSize:11,color:"#BECCE2",fontWeight:"bold",marginBottom:5},bubble:{backgroundImage:"linear-gradient(225deg, #6CC1FF 0%, #3A8DFF 100%)",borderRadius:"0 10px 10px 10px"},text:{fontSize:14,fontWeight:"bold",color:"#FFFFFF",letterSpacing:-.2,padding:8}}})),re=function(e){var t=e.text,r=e.time,n=e.otherUser,a=te();return Object(S.jsxs)(O.a,{className:a.root,children:[Object(S.jsx)(X.a,{alt:n.username,src:n.photoUrl,className:a.avatar}),Object(S.jsxs)(O.a,{children:[Object(S.jsxs)(v.a,{className:a.usernameDate,children:[n.username," ",r]}),Object(S.jsx)(O.a,{className:a.bubble,children:Object(S.jsx)(v.a,{className:a.text,children:t})})]})]})},ne=Object(E.a)((function(){return{root:{display:"flex",flexGrow:8,flexDirection:"column"},chatContainer:{marginLeft:41,marginRight:41,display:"flex",flexDirection:"column",flexGrow:1,justifyContent:"space-between"}}})),ae=function(e){var t,r=e.user,n=e.conversations,a=e.activeConversation,s=e.postMessage,c=ne(),o=n?n.find((function(e){return e.otherUser.username===a})):{};return Object(S.jsx)(O.a,{className:c.root,children:(t=o,t!=={}&&void 0!==t&&o.otherUser&&Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(ie,{username:o.otherUser.username,online:o.otherUser.online||!1}),Object(S.jsx)(O.a,{className:c.chatContainer,children:r&&Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(de,{messages:o.messages,otherUser:o.otherUser,userId:r.id}),Object(S.jsx)(ce,{otherUser:o.otherUser,conversationId:o.id||null,user:r,postMessage:s})]})})]}))})},se=Object(E.a)((function(){return{root:{justifySelf:"flex-end",marginTop:15},input:{height:70,backgroundColor:"#F4F6FA",borderRadius:8,marginBottom:20}}})),ce=function(e){var t=e.otherUser,r=e.conversationId,a=e.user,s=e.postMessage,c=se(),i=Object(n.useState)(""),l=Object(h.a)(i,2),d=l[0],j=l[1],b=function(){var e=Object(o.a)(u.a.mark((function e(n){var c,o,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),c=n.currentTarget,o=c.elements,i={text:o.text.value,recipientId:t.id,conversationId:r,sender:r?null:a},e.next=6,s(i);case 6:j("");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(S.jsx)("form",{className:c.root,onSubmit:b,children:Object(S.jsx)(C.a,{fullWidth:!0,hiddenLabel:!0,children:Object(S.jsx)(z.a,{classes:{root:c.input},disableUnderline:!0,placeholder:"Type something...",value:d,name:"text",onChange:function(e){j(e.target.value)}})})})},oe=Object(E.a)((function(e){return{root:{display:"flex",alignItems:"center",justifyContent:"space-between",height:89,marginBottom:34,boxShadow:"0 2px 20px 0 rgba(88,133,196,0.10)"},content:{display:"flex",alignItems:"center",marginLeft:24},username:{fontSize:20,letterSpacing:-.29,fontWeight:"bold",marginRight:14},statusText:{fontSize:12,color:"#BFC9DB",letterSpacing:-.17},statusDot:{height:8,width:8,borderRadius:"50%",marginRight:5,backgroundColor:"#D0DAE9"},online:{background:"#1CED84"},ellipsis:{color:"#95A7C4",marginRight:24,opacity:.5}}})),ie=function(e){var t=e.username,r=e.online,n=oe();return Object(S.jsxs)(O.a,{className:n.root,children:[Object(S.jsxs)(O.a,{className:n.content,children:[Object(S.jsx)(v.a,{className:n.username,children:t}),Object(S.jsx)(O.a,{className:"".concat(n.statusDot," ").concat(r&&n.online)}),Object(S.jsx)(v.a,{className:n.statusText,children:r?"Online":"Offline"})]}),Object(S.jsx)(T.a,{classes:{root:n.ellipsis}})]})},ue=r(116),le=r.n(ue),de=function(e){var t=e.messages,r=e.otherUser,n=e.userId;return Object(S.jsx)(O.a,{children:t.map((function(e){var t=le()(e.createdAt).format("h:mm");return e.senderId===n?Object(S.jsx)(ee,{text:e.text,time:t},e.id):Object(S.jsx)(re,{text:e.text,time:t,otherUser:r},e.id)}))})},je=r(117),be=Object(je.io)(window.location.origin);be.on("connect",(function(){console.log("connected to server")}));var fe=a.a.createContext(),he=Object(E.a)((function(e){return{root:{height:"100vh"}}})),pe=function(e){var t=e.user,r=e.logout,a=Object(x.f)(),s=Object(n.useContext)(fe),c=Object(n.useState)([]),i=Object(h.a)(c,2),l=i[0],d=i[1],j=Object(n.useState)(null),b=Object(h.a)(j,2),p=b[0],O=b[1],v=he(),C=Object(n.useState)(!1),y=Object(h.a)(C,2),k=y[0],U=y[1],N=function(){var e=Object(o.a)(u.a.mark((function e(t){var r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("/api/messages",t);case 2:return r=e.sent,n=r.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=Object(n.useCallback)((function(e,t){l.forEach((function(r){r.otherUser.id===e&&(r.messages.push(t),r.latestMessageText=t.text,r.id=t.conversationId)})),d(l)}),[d,l]),D=Object(n.useCallback)((function(e){var t=e.message,r=e.sender,n=void 0===r?null:r;if(null!==n){var a={id:t.conversationId,otherUser:n,messages:[t]};a.latestMessageText=t.text,d((function(e){return[a].concat(Object(F.a)(e))}))}l.forEach((function(e){e.id===t.conversationId&&(e.messages.push(t),e.latestMessageText=t.text)})),d(l)}),[d,l]),A=Object(n.useCallback)((function(e){d((function(t){return t.map((function(t){if(t.otherUser.id===e){var r=Object(f.a)({},t);return r.otherUser=Object(f.a)(Object(f.a)({},r.otherUser),{},{online:!0}),r}return t}))}))}),[]),B=Object(n.useCallback)((function(e){d((function(t){return t.map((function(t){if(t.otherUser.id===e){var r=Object(f.a)({},t);return r.otherUser=Object(f.a)(Object(f.a)({},r.otherUser),{},{online:!1}),r}return t}))}))}),[]);Object(n.useEffect)((function(){return s.on("add-online-user",A),s.on("remove-offline-user",B),s.on("new-message",D),function(){s.off("add-online-user",A),s.off("remove-offline-user",B),s.off("new-message",D)}}),[D,A,B,s]),Object(n.useEffect)((function(){null!==t&&void 0!==t&&t.isFetching||(t&&t.id?U(!0):k?a.push("/login"):a.push("/register"))}),[t,a,k]),Object(n.useEffect)((function(){var e=function(){var e=Object(o.a)(u.a.mark((function e(){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.get("/api/conversations");case 3:t=e.sent,r=t.data,d(r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();t.isFetching||e()}),[t]);var T=function(){var e=Object(o.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!t.id){e.next=3;break}return e.next=3,r(t.id);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(w.a,{onClick:T,children:"Logout"}),Object(S.jsxs)(g.a,{container:!0,component:"main",className:v.root,children:[Object(S.jsx)(I.a,{}),Object(S.jsx)(H,{conversations:l,user:t,clearSearchedUsers:function(){d((function(e){return e.filter((function(e){return e.id}))}))},addSearchedUsers:function(e){var t={};l.forEach((function(e){t[e.otherUser.id]=!0}));var r=Object(F.a)(l);e.forEach((function(e){if(!t[e.id]){var n={otherUser:e,messages:[]};r.push(n)}})),d(r)},setActiveChat:function(e){O(e)}}),Object(S.jsx)(ae,{activeConversation:p,conversations:l,user:t,postMessage:function(e){try{var t=N(e);e.conversationId?D(t):E(e.recipientId,t.message),function(e,t){s.emit("new-message",{message:e.message,recipientId:t.recipientId,sender:e.sender})}(t,e)}catch(r){console.error(r)}}})]})]})},me=r(238),xe=r(118),ge=r.n(xe),Oe=Object(E.a)((function(e){return{snackbar:{backgroundColor:"red",fontWeight:"bold"},icon:{color:"white"}}})),ve=function(e){var t=e.setSnackBarOpen,r=e.errorMessage,n=e.snackBarOpen,s=Oe();return Object(S.jsx)(me.a,{open:n,onClose:function(){return t(!1)},message:r||"Sorry, an error occured. Please try again",action:Object(S.jsx)(a.a.Fragment,{children:Object(S.jsx)(w.a,{className:s.icon,size:"small",onClick:function(){return t(!1)},children:Object(S.jsx)(ge.a,{color:"secondary"})})}),ContentProps:{classes:{root:s.snackbar}}})},we=Object(x.g)((function(e){var t=Object(n.useState)({isFetching:!0}),r=Object(h.a)(t,2),a=r[0],s=r[1],c=Object(n.useState)(""),i=Object(h.a)(c,2),l=i[0],d=i[1],j=Object(n.useState)(!1),b=Object(h.a)(j,2),p=b[0],g=b[1],O=function(){var e=Object(o.a)(u.a.mark((function e(t){var r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.post("/auth/login",t);case 3:return r=e.sent,n=r.data,e.next=7,localStorage.setItem("messenger-token",n.token);case 7:s(n),be.emit("go-online",n.id),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0),s({error:e.t0.response.data.error||"Server Error"});case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(o.a)(u.a.mark((function e(t){var r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.post("/auth/register",t);case 3:return r=e.sent,n=r.data,e.next=7,localStorage.setItem("messenger-token",n.token);case 7:s(n),be.emit("go-online",n.id),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0),s({error:e.t0.response.data.error||"Server Error"});case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(o.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.delete("/auth/logout");case 3:return e.next=5,localStorage.removeItem("messenger-token");case 5:s({}),be.emit("logout",t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){var e=function(){var e=Object(o.a)(u.a.mark((function e(){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s((function(e){return Object(f.a)(Object(f.a)({},e),{},{isFetching:!0})})),e.prev=1,e.next=4,m.a.get("/auth/user");case 4:t=e.sent,r=t.data,s(r),r.id&&be.emit("go-online",r.id),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0);case 13:return e.prev=13,s((function(e){return Object(f.a)(Object(f.a)({},e),{},{isFetching:!1})})),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[1,10,13,16]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),Object(n.useEffect)((function(){null!==a&&void 0!==a&&a.error&&("string"===typeof a.error?d(a.error):d("Internal Server Error. Please try again"),g(!0))}),[null===a||void 0===a?void 0:a.error]),null!==a&&void 0!==a&&a.isFetching?Object(S.jsx)("div",{children:"Loading..."}):Object(S.jsxs)(fe.Provider,{value:be,children:[p&&Object(S.jsx)(ve,{setSnackBarOpen:g,errorMessage:l,snackBarOpen:p}),Object(S.jsxs)(x.c,{children:[Object(S.jsx)(x.a,{path:"/login",render:function(){return Object(S.jsx)(N,{user:a,login:O})}}),Object(S.jsx)(x.a,{path:"/register",render:function(){return Object(S.jsx)(U,{user:a,register:v})}}),Object(S.jsx)(x.a,{exact:!0,path:"/",render:function(e){return null!==a&&void 0!==a&&a.id?Object(S.jsx)(pe,{user:a,logout:w}):Object(S.jsx)(U,{user:a,register:v})}}),Object(S.jsx)(x.a,{path:"/home",render:function(){return Object(S.jsx)(pe,{user:a,logout:w})}})]})]})}));m.a.interceptors.request.use(function(){var e=Object(o.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,localStorage.getItem("messenger-token");case 2:return r=e.sent,t.headers["x-access-token"]=r,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var Ce=function(){return Object(S.jsx)(l.a,{theme:b,children:Object(S.jsx)(d.a,{children:Object(S.jsx)(we,{})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(S.jsx)(Ce,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[192,1,2]]]);
//# sourceMappingURL=main.02117352.chunk.js.map